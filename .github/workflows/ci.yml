name: Python Tests

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Baixar código
        uses: actions/checkout@v3

      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Instalar dependências (incluindo linter)
        run: |
          # Adiciona flake8 para validação de qualidade do código
          pip install flask pytest flake8 

      - name: 1. Rodar Testes
        run: |
          pytest
          
      # Novo Passo Adicionado: Validação de Qualidade
      - name: 2. Validar Qualidade do Código (Flake8)
        run: |
          # O Flake8 verifica problemas de estilo, sintaxe e complexidade
          flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
          # Se o flake8 encontrar erros, o passo falhará, garantindo a qualidade.
