name: Python Tests

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Baixar código
        uses: actions/checkout@v3

      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Instalar dependências (incluindo linter)
        run: |
          # Adiciona flake8 para validação de qualidade do código
          pip install flask pytest flake8 

    - name: Rodar Testes
  run: |
    # Agora o pytest vai procurar testes apenas no diretório /tests
    pytest tests/
          
      # Novo Passo Adicionado: Validação de Qualidade
      - name: Validar Qualidade do Código (Flake8)
  run: |
    # Flake8 deve olhar tanto src/ quanto tests/
    flake8 src/ tests/ --count --select=E9,F63,F7,F82 --show-source --statistics
    flake8 src/ tests/ --count --max-complexity=10 --max-line-length=127 --exit-zero
